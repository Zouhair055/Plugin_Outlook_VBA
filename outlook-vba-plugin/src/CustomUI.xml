<?xml version="1.0" encoding="UTF-8"?>
<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" onLoad="OnRibbonLoad">
  
  <!-- ========================================
       CUSTOM UI XML - INTERFACE RUBAN OUTLOOK
       ========================================
       
       Description: Configuration XML pour ajouter des boutons personnalisés 
                   dans le ruban Outlook pour la signature automatique de PDFs
       
       Cibles: Onglet "Accueil" et "Message" d'Outlook
       
       ======================================== -->
  
  <ribbon>
    <tabs>
      
      <!-- ========================================
           ONGLET PRINCIPAL OUTLOOK (LECTURE EMAIL)
           ======================================== -->
      <tab idMso="TabMail">
        <group id="grpPDFSignature" 
               label="PDF Signature Assistant" 
               insertAfterMso="GroupRespond">
          
          <!-- Bouton principal de signature -->
          <button id="btnSignPDFs"
                  label="Signer PDFs"
                  size="large"
                  imageMso="PictureInsertFromFile"
                  onAction="OnSignPDFs"
                  getEnabled="GetButtonEnabled"
                  getScreentip="GetButtonScreentip"
                  getSupertip="GetButtonSupertip" />
          
          <!-- Séparateur -->
          <separator id="sep1" />
          
          <!-- Bouton de test API -->
          <button id="btnTestAPI"
                  label="Test API"
                  size="normal"
                  imageMso="DatabaseConnectionStatusOnline"
                  onAction="OnTestAPI"
                  getScreentip="GetButtonScreentip"
                  getSupertip="GetButtonSupertip" />
          
        </group>
      </tab>
      
      <!-- ========================================
           ONGLET COMPOSITION EMAIL (REPONSE/NOUVEAU)
           ======================================== -->
      <tab idMso="TabMessage">
        <group id="grpPDFSignatureCompose" 
               label="PDF Signature" 
               insertAfterMso="GroupMessageOptions">
          
          <!-- Bouton signature pour composition -->
          <button id="btnSignPDFsCompose"
                  label="Signer PDFs"
                  size="normal"
                  imageMso="PictureInsertFromFile"
                  onAction="OnSignPDFs"
                  getScreentip="GetButtonScreentip"
                  getSupertip="GetButtonSupertip" />
          
        </group>
      </tab>
      
      <!-- ========================================
           ONGLET EXPLORATEUR OUTLOOK (LISTE EMAILS)
           ======================================== -->
      <tab idMso="TabFolderHome">
        <group id="grpPDFSignatureExplorer" 
               label="PDF Tools" 
               insertAfterMso="GroupActions">
          
          <!-- Bouton pour traitement en lot -->
          <button id="btnBatchSignPDFs"
                  label="Signature Lot"
                  size="normal"
                  imageMso="PictureInsertFromFile"
                  onAction="OnBatchSignPDFs"
                  getScreentip="GetButtonScreentip"
                  getSupertip="GetButtonSupertip" />
          
          <!-- Menu déroulant pour options avancées -->
          <menu id="mnuPDFOptions" 
                label="Options PDF"
                size="normal"
                imageMso="ControlProperties">
            
            <!-- Configuration de signature -->
            <button id="btnConfigSignature"
                    label="Configurer Signature"
                    imageMso="FormControlProperties"
                    onAction="OnConfigureSignature" />
            
            <!-- Ouvrir dossier des signés -->
            <button id="btnOpenSignedFolder"
                    label="Ouvrir Dossier Signés"
                    imageMso="FolderOpen"
                    onAction="OnOpenSignedFolder" />
            
            <!-- À propos -->
            <button id="btnAbout"
                    label="À propos"
                    imageMso="Info"
                    onAction="OnShowAbout" />
            
          </menu>
          
        </group>
      </tab>
      
    </tabs>
  </ribbon>
  
  <!-- ========================================
       MENU CONTEXTUEL (CLIC DROIT SUR EMAIL)
       ======================================== -->
  <contextMenus>
    
    <!-- Menu contextuel pour les emails -->
    <contextMenu idMso="ContextMenuMailItem">
      
      <!-- Groupe PDF Signature dans le menu contextuel -->
      <menu id="mnuContextPDFSignature" 
            label="PDF Signature Assistant"
            imageMso="PictureInsertFromFile"
            insertBeforeMso="ContextMenuMailItemOpenInNewWindow">
        
        <!-- Signer PDFs directement -->
        <button id="btnContextSignPDFs"
                label="Signer tous les PDFs"
                imageMso="PictureInsertFromFile"
                onAction="OnSignPDFs"
                getEnabled="GetButtonEnabled" />
        
        <!-- Prévisualiser les PDFs -->
        <button id="btnContextPreviewPDFs"
                label="Prévisualiser PDFs"
                imageMso="PrintPreview"
                onAction="OnPreviewPDFs" />
        
        <!-- Sauvegarder PDFs localement -->
        <button id="btnContextSavePDFs"
                label="Extraire PDFs"
                imageMso="FileSave"
                onAction="OnExtractPDFs" />
        
      </menu>
      
    </contextMenu>
    
    <!-- Menu contextuel pour les pièces jointes -->
    <contextMenu idMso="ContextMenuAttachments">
      
      <!-- Option pour signer une pièce jointe spécifique -->
      <button id="btnContextSignAttachment"
              label="Signer ce PDF"
              imageMso="PictureInsertFromFile"
              onAction="OnSignSinglePDF"
              insertBeforeMso="AttachmentSave" />
      
    </contextMenu>
    
  </contextMenus>
  
</customUI>
